

test: 5:
any:{ cross(close, sma(20), delay=1, threshold=0.01) } | buy

tree1:  any:{ cross(close, sma(20), delay=1, threshold=0.01) } | buy
    1  : Flow{TK.CHAIN, '|' len=2}
    2  :     UnaryOp(TK.ANY, 'any')
    3  :         Generate(TK.SET, len=1)
    4  :             FnCall('cross')
    5  :                 Get(TK.IDENT, 'cross')
    6  :                 Generate(TK.NAMEDTUPLE, len=4)
    7  :                     Get(TK.IDENT, 'close')
    8  :                     FnCall('sma')
    9  :                         Get(TK.IDENT, 'sma')
   10  :                         List(TK.LIST, [Int()])
   11  :                             Int(TK.INT, 20)
   12  :                     Define(TK.DEFINE: delay = 1)
   13  :                         Ref(TK.IDENT, 'delay')
   14  :                         Int(TK.INT, 1)
   15  :                     Define(TK.DEFINE: threshold = 0.01)
   16  :                         Ref(TK.IDENT, 'threshold')
   17  :                         Float(TK.FLOT, 0.01)
   18  :     ApplyChainProd(TK.APPLY: None | Ref(TK.IDENT, 'buy'))
   19  :         Ref(TK.IDENT, 'buy')

tree1:(post)  any:{ cross(close, sma(20), delay=1, threshold=0.01) } | buy
result: list([UnaryOp(), ApplyChainProd()])
    1  : Flow{TK.CHAIN, '|' len=2}
    2  :     UnaryOp(TK.ANY, 'any')
    3  :         Generate(TK.SET, len=1)
    4  :             FnCall('cross')
    5  :                 Get(TK.IDENT, 'cross')
    6  :                 Generate(TK.NAMEDTUPLE, len=4)
    7  :                     Get(TK.IDENT, 'close')
    8  :                     FnCall('sma')
    9  :                         Get(TK.IDENT, 'sma')
   10  :                         List(TK.LIST, [Int()])
   11  :                             Int(TK.INT, 20)
   12  :                     Define(TK.DEFINE: delay = 1)
   13  :                         Ref(TK.IDENT, 'delay')
   14  :                         Int(TK.INT, 1)
   15  :                     Define(TK.DEFINE: threshold = 0.01)
   16  :                         Ref(TK.IDENT, 'threshold')
   17  :                         Float(TK.FLOT, 0.01)
   18  :     ApplyChainProd(TK.APPLY: None | Ref(TK.IDENT, 'buy'))
   19  :         Ref(TK.IDENT, 'buy')
