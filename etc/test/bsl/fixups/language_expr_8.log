

test: 8:
{close.sma(20) and close.sma(50)} | diff | sign | signal(how='cross')

tree1:  {close.sma(20) and close.sma(50)} | diff | sign | signal(how='cross')
    1  : Flow(TK.CHAIN, v=[Block(), Ref(), Ref(), FnCall()], '|')
    2  :     Block(TK.BLOCK, v=[BinOp()], '')
    3  :         BinOp(TK.AND, 'and')
    4  :             PropRef(TK.REF, '.')
    5  :                 Get(TK.IDNT, 'close')
    6  :                 FnCall('sma')
    7  :                     Get(TK.IDNT, 'sma')
    8  :                     List(TK.TUPLE, [Int()])
    9  :                         Int(TK.INT, 20)
   10  :             PropRef(TK.REF, '.')
   11  :                 Get(TK.IDNT, 'close')
   12  :                 FnCall('sma')
   13  :                     Get(TK.IDNT, 'sma')
   14  :                     List(TK.TUPLE, [Int()])
   15  :                         Int(TK.INT, 50)
   16  :     Ref(TK.IDNT, 'diff')
   17  :     Ref(TK.IDNT, 'sign')
   18  :     FnCall('signal')
   19  :         Ref(TK.SIGNAL, 'signal')
   20  :         List(TK.TUPLE, [Define()])
   21  :             Define(TK.DEFINE, TK.EQLS, '=')
   22  :                 Ref(TK.IDNT, 'how')
   23  :                 Str(TK.STR, cross)

tree1:(post)  {close.sma(20) and close.sma(50)} | diff | sign | signal(how='cross')
result: list([Block(), Ref(), Ref(), FnCall()])
    1  : Flow(TK.CHAIN, v=[Block(), Ref(), Ref(), FnCall()], '|')
    2  :     Block(TK.BLOCK, v=[BinOp()], '')
    3  :         BinOp(TK.AND, 'and')
    4  :             PropRef(TK.REF, '.')
    5  :                 Get(TK.IDNT, 'close')
    6  :                 FnCall('sma')
    7  :                     Get(TK.IDNT, 'sma')
    8  :                     List(TK.TUPLE, [Int()])
    9  :                         Int(TK.INT, 20)
   10  :             PropRef(TK.REF, '.')
   11  :                 Get(TK.IDNT, 'close')
   12  :                 FnCall('sma')
   13  :                     Get(TK.IDNT, 'sma')
   14  :                     List(TK.TUPLE, [Int()])
   15  :                         Int(TK.INT, 50)
   16  :     Ref(TK.IDNT, 'diff')
   17  :     Ref(TK.IDNT, 'sign')
   18  :     FnCall('signal')
   19  :         Ref(TK.SIGNAL, 'signal')
   20  :         List(TK.TUPLE, [Define()])
   21  :             Define(TK.DEFINE, TK.EQLS, '=')
   22  :                 Ref(TK.IDNT, 'how')
   23  :                 Str(TK.STR, cross)
