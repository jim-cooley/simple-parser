

test:
# datasets:
df = pd.DataFrame(
    {
        "one": pd.Series(np.random.randn(3), index=["a", "b", "c"]),
        "two": pd.Series(np.random.randn(4), index=["a", "b", "c", "d"]),
        "three": pd.Series(np.random.randn(3), index=["b", "c", "d"]),
    }
)

df = {
    "one": pd.Series(np.random.randn(3), index=["a", "b", "c"]),
    "two": pd.Series(np.random.randn(4), index=["a", "b", "c", "d"]),
    "three": pd.Series(np.random.randn(3), index=["b", "c", "d"]),
}



tree1:  df = pd.DataFrame(
    1  : Define(TK.DEFINE, TK.EQLS, '=')
    2  :     Ref(TK.IDNT, 'df')
    3  :     PropRef(TK.REF, '.')
    4  :         Get(TK.IDNT, 'pd')
    5  :         FnCall('DataFrame')
    6  :             Get(TK.IDNT, 'DataFrame')
    7  :             List(TK.TUPLE, [Block()])
    8  :                 Block(TK.BLOCK, v=[Define(), Define(), Define()], '')
    9  :                     Define(TK.DEFINE, TK.COLN, ':')
   10  :                         Str(TK.STR, one)
   11  :                         PropRef(TK.REF, '.')
   12  :                             Get(TK.IDNT, 'pd')
   13  :                             FnCall('Series')
   14  :                                 Get(TK.IDNT, 'Series')
   15  :                                 List(TK.TUPLE, [PropRef(), Define()])
   16  :                                     PropRef(TK.REF, '.')
   17  :                                         Get(TK.IDNT, 'np')
   18  :                                         PropRef(TK.REF, '.')
   19  :                                             Get(TK.IDNT, 'random')
   20  :                                             FnCall('randn')
   21  :                                                 Get(TK.IDNT, 'randn')
   22  :                                                 List(TK.TUPLE, [Int()])
   23  :                                                     Int(TK.INT, 3)
   24  :                                     Define(TK.DEFINE, TK.EQLS, '=')
   25  :                                         Ref(TK.IDNT, 'index')
   26  :                                         List(TK.LIST, [Str(), Str(), Str()])
   27  :                                             Str(TK.STR, a)
   28  :                                             Str(TK.STR, b)
   29  :                                             Str(TK.STR, c)
   30  :                     Define(TK.DEFINE, TK.COLN, ':')
   31  :                         Str(TK.STR, two)
   32  :                         PropRef(TK.REF, '.')
   33  :                             Get(TK.IDNT, 'pd')
   34  :                             FnCall('Series')
   35  :                                 Get(TK.IDNT, 'Series')
   36  :                                 List(TK.TUPLE, [PropRef(), Define()])
   37  :                                     PropRef(TK.REF, '.')
   38  :                                         Get(TK.IDNT, 'np')
   39  :                                         PropRef(TK.REF, '.')
   40  :                                             Get(TK.IDNT, 'random')
   41  :                                             FnCall('randn')
   42  :                                                 Get(TK.IDNT, 'randn')
   43  :                                                 List(TK.TUPLE, [Int()])
   44  :                                                     Int(TK.INT, 4)
   45  :                                     Define(TK.DEFINE, TK.EQLS, '=')
   46  :                                         Ref(TK.IDNT, 'index')
   47  :                                         List(TK.LIST, [Str(), Str(), Str(), Str()])
   48  :                                             Str(TK.STR, a)
   49  :                                             Str(TK.STR, b)
   50  :                                             Str(TK.STR, c)
   51  :                                             Str(TK.STR, d)
   52  :                     Define(TK.DEFINE, TK.COLN, ':')
   53  :                         Str(TK.STR, three)
   54  :                         PropRef(TK.REF, '.')
   55  :                             Get(TK.IDNT, 'pd')
   56  :                             FnCall('Series')
   57  :                                 Get(TK.IDNT, 'Series')
   58  :                                 List(TK.TUPLE, [PropRef(), Define()])
   59  :                                     PropRef(TK.REF, '.')
   60  :                                         Get(TK.IDNT, 'np')
   61  :                                         PropRef(TK.REF, '.')
   62  :                                             Get(TK.IDNT, 'random')
   63  :                                             FnCall('randn')
   64  :                                                 Get(TK.IDNT, 'randn')
   65  :                                                 List(TK.TUPLE, [Int()])
   66  :                                                     Int(TK.INT, 3)
   67  :                                     Define(TK.DEFINE, TK.EQLS, '=')
   68  :                                         Ref(TK.IDNT, 'index')
   69  :                                         List(TK.LIST, [Str(), Str(), Str()])
   70  :                                             Str(TK.STR, b)
   71  :                                             Str(TK.STR, c)
   72  :                                             Str(TK.STR, d)

tree2:  df = {
    1  : Define(TK.DEFINE, TK.EQLS, '=')
    2  :     Ref(TK.IDNT, 'df')
    3  :     Block(TK.BLOCK, v=[Define(), Define(), Define()], '')
    4  :         Define(TK.DEFINE, TK.COLN, ':')
    5  :             Str(TK.STR, one)
    6  :             PropRef(TK.REF, '.')
    7  :                 Get(TK.IDNT, 'pd')
    8  :                 FnCall('Series')
    9  :                     Get(TK.IDNT, 'Series')
   10  :                     List(TK.TUPLE, [PropRef(), Define()])
   11  :                         PropRef(TK.REF, '.')
   12  :                             Get(TK.IDNT, 'np')
   13  :                             PropRef(TK.REF, '.')
   14  :                                 Get(TK.IDNT, 'random')
   15  :                                 FnCall('randn')
   16  :                                     Get(TK.IDNT, 'randn')
   17  :                                     List(TK.TUPLE, [Int()])
   18  :                                         Int(TK.INT, 3)
   19  :                         Define(TK.DEFINE, TK.EQLS, '=')
   20  :                             Ref(TK.IDNT, 'index')
   21  :                             List(TK.LIST, [Str(), Str(), Str()])
   22  :                                 Str(TK.STR, a)
   23  :                                 Str(TK.STR, b)
   24  :                                 Str(TK.STR, c)
   25  :         Define(TK.DEFINE, TK.COLN, ':')
   26  :             Str(TK.STR, two)
   27  :             PropRef(TK.REF, '.')
   28  :                 Get(TK.IDNT, 'pd')
   29  :                 FnCall('Series')
   30  :                     Get(TK.IDNT, 'Series')
   31  :                     List(TK.TUPLE, [PropRef(), Define()])
   32  :                         PropRef(TK.REF, '.')
   33  :                             Get(TK.IDNT, 'np')
   34  :                             PropRef(TK.REF, '.')
   35  :                                 Get(TK.IDNT, 'random')
   36  :                                 FnCall('randn')
   37  :                                     Get(TK.IDNT, 'randn')
   38  :                                     List(TK.TUPLE, [Int()])
   39  :                                         Int(TK.INT, 4)
   40  :                         Define(TK.DEFINE, TK.EQLS, '=')
   41  :                             Ref(TK.IDNT, 'index')
   42  :                             List(TK.LIST, [Str(), Str(), Str(), Str()])
   43  :                                 Str(TK.STR, a)
   44  :                                 Str(TK.STR, b)
   45  :                                 Str(TK.STR, c)
   46  :                                 Str(TK.STR, d)
   47  :         Define(TK.DEFINE, TK.COLN, ':')
   48  :             Str(TK.STR, three)
   49  :             PropRef(TK.REF, '.')
   50  :                 Get(TK.IDNT, 'pd')
   51  :                 FnCall('Series')
   52  :                     Get(TK.IDNT, 'Series')
   53  :                     List(TK.TUPLE, [PropRef(), Define()])
   54  :                         PropRef(TK.REF, '.')
   55  :                             Get(TK.IDNT, 'np')
   56  :                             PropRef(TK.REF, '.')
   57  :                                 Get(TK.IDNT, 'random')
   58  :                                 FnCall('randn')
   59  :                                     Get(TK.IDNT, 'randn')
   60  :                                     List(TK.TUPLE, [Int()])
   61  :                                         Int(TK.INT, 3)
   62  :                         Define(TK.DEFINE, TK.EQLS, '=')
   63  :                             Ref(TK.IDNT, 'index')
   64  :                             List(TK.LIST, [Str(), Str(), Str()])
   65  :                                 Str(TK.STR, b)
   66  :                                 Str(TK.STR, c)
   67  :                                 Str(TK.STR, d)

tree1:(post)  df = pd.DataFrame(
    1  : Define(TK.DEFINE, TK.EQLS, '=')
    2  :     Ref(TK.IDNT, 'df')
    3  :     PropRef(TK.REF, '.')
    4  :         Get(TK.IDNT, 'pd')
    5  :         FnCall('DataFrame')
    6  :             Get(TK.IDNT, 'DataFrame')
    7  :             List(TK.TUPLE, [Block()])
    8  :                 Block(TK.BLOCK, v=[Define(), Define(), Define()], '')
    9  :                     Define(TK.DEFINE, TK.COLN, ':')
   10  :                         Str(TK.STR, one)
   11  :                         PropRef(TK.REF, '.')
   12  :                             Get(TK.IDNT, 'pd')
   13  :                             FnCall('Series')
   14  :                                 Get(TK.IDNT, 'Series')
   15  :                                 List(TK.TUPLE, [PropRef(), Define()])
   16  :                                     PropRef(TK.REF, '.')
   17  :                                         Get(TK.IDNT, 'np')
   18  :                                         PropRef(TK.REF, '.')
   19  :                                             Get(TK.IDNT, 'random')
   20  :                                             FnCall('randn')
   21  :                                                 Get(TK.IDNT, 'randn')
   22  :                                                 List(TK.TUPLE, [Int()])
   23  :                                                     Int(TK.INT, 3)
   24  :                                     Define(TK.DEFINE, TK.EQLS, '=')
   25  :                                         Ref(TK.IDNT, 'index')
   26  :                                         List(TK.LIST, [Str(), Str(), Str()])
   27  :                                             Str(TK.STR, a)
   28  :                                             Str(TK.STR, b)
   29  :                                             Str(TK.STR, c)
   30  :                     Define(TK.DEFINE, TK.COLN, ':')
   31  :                         Str(TK.STR, two)
   32  :                         PropRef(TK.REF, '.')
   33  :                             Get(TK.IDNT, 'pd')
   34  :                             FnCall('Series')
   35  :                                 Get(TK.IDNT, 'Series')
   36  :                                 List(TK.TUPLE, [PropRef(), Define()])
   37  :                                     PropRef(TK.REF, '.')
   38  :                                         Get(TK.IDNT, 'np')
   39  :                                         PropRef(TK.REF, '.')
   40  :                                             Get(TK.IDNT, 'random')
   41  :                                             FnCall('randn')
   42  :                                                 Get(TK.IDNT, 'randn')
   43  :                                                 List(TK.TUPLE, [Int()])
   44  :                                                     Int(TK.INT, 4)
   45  :                                     Define(TK.DEFINE, TK.EQLS, '=')
   46  :                                         Ref(TK.IDNT, 'index')
   47  :                                         List(TK.LIST, [Str(), Str(), Str(), Str()])
   48  :                                             Str(TK.STR, a)
   49  :                                             Str(TK.STR, b)
   50  :                                             Str(TK.STR, c)
   51  :                                             Str(TK.STR, d)
   52  :                     Define(TK.DEFINE, TK.COLN, ':')
   53  :                         Str(TK.STR, three)
   54  :                         PropRef(TK.REF, '.')
   55  :                             Get(TK.IDNT, 'pd')
   56  :                             FnCall('Series')
   57  :                                 Get(TK.IDNT, 'Series')
   58  :                                 List(TK.TUPLE, [PropRef(), Define()])
   59  :                                     PropRef(TK.REF, '.')
   60  :                                         Get(TK.IDNT, 'np')
   61  :                                         PropRef(TK.REF, '.')
   62  :                                             Get(TK.IDNT, 'random')
   63  :                                             FnCall('randn')
   64  :                                                 Get(TK.IDNT, 'randn')
   65  :                                                 List(TK.TUPLE, [Int()])
   66  :                                                     Int(TK.INT, 3)
   67  :                                     Define(TK.DEFINE, TK.EQLS, '=')
   68  :                                         Ref(TK.IDNT, 'index')
   69  :                                         List(TK.LIST, [Str(), Str(), Str()])
   70  :                                             Str(TK.STR, b)
   71  :                                             Str(TK.STR, c)
   72  :                                             Str(TK.STR, d)

tree2:(post)  df = {
    1  : Define(TK.DEFINE, TK.EQLS, '=')
    2  :     Ref(TK.IDNT, 'df')
    3  :     Block(TK.BLOCK, v=[Define(), Define(), Define()], '')
    4  :         Define(TK.DEFINE, TK.COLN, ':')
    5  :             Str(TK.STR, one)
    6  :             PropRef(TK.REF, '.')
    7  :                 Get(TK.IDNT, 'pd')
    8  :                 FnCall('Series')
    9  :                     Get(TK.IDNT, 'Series')
   10  :                     List(TK.TUPLE, [PropRef(), Define()])
   11  :                         PropRef(TK.REF, '.')
   12  :                             Get(TK.IDNT, 'np')
   13  :                             PropRef(TK.REF, '.')
   14  :                                 Get(TK.IDNT, 'random')
   15  :                                 FnCall('randn')
   16  :                                     Get(TK.IDNT, 'randn')
   17  :                                     List(TK.TUPLE, [Int()])
   18  :                                         Int(TK.INT, 3)
   19  :                         Define(TK.DEFINE, TK.EQLS, '=')
   20  :                             Ref(TK.IDNT, 'index')
   21  :                             List(TK.LIST, [Str(), Str(), Str()])
   22  :                                 Str(TK.STR, a)
   23  :                                 Str(TK.STR, b)
   24  :                                 Str(TK.STR, c)
   25  :         Define(TK.DEFINE, TK.COLN, ':')
   26  :             Str(TK.STR, two)
   27  :             PropRef(TK.REF, '.')
   28  :                 Get(TK.IDNT, 'pd')
   29  :                 FnCall('Series')
   30  :                     Get(TK.IDNT, 'Series')
   31  :                     List(TK.TUPLE, [PropRef(), Define()])
   32  :                         PropRef(TK.REF, '.')
   33  :                             Get(TK.IDNT, 'np')
   34  :                             PropRef(TK.REF, '.')
   35  :                                 Get(TK.IDNT, 'random')
   36  :                                 FnCall('randn')
   37  :                                     Get(TK.IDNT, 'randn')
   38  :                                     List(TK.TUPLE, [Int()])
   39  :                                         Int(TK.INT, 4)
   40  :                         Define(TK.DEFINE, TK.EQLS, '=')
   41  :                             Ref(TK.IDNT, 'index')
   42  :                             List(TK.LIST, [Str(), Str(), Str(), Str()])
   43  :                                 Str(TK.STR, a)
   44  :                                 Str(TK.STR, b)
   45  :                                 Str(TK.STR, c)
   46  :                                 Str(TK.STR, d)
   47  :         Define(TK.DEFINE, TK.COLN, ':')
   48  :             Str(TK.STR, three)
   49  :             PropRef(TK.REF, '.')
   50  :                 Get(TK.IDNT, 'pd')
   51  :                 FnCall('Series')
   52  :                     Get(TK.IDNT, 'Series')
   53  :                     List(TK.TUPLE, [PropRef(), Define()])
   54  :                         PropRef(TK.REF, '.')
   55  :                             Get(TK.IDNT, 'np')
   56  :                             PropRef(TK.REF, '.')
   57  :                                 Get(TK.IDNT, 'random')
   58  :                                 FnCall('randn')
   59  :                                     Get(TK.IDNT, 'randn')
   60  :                                     List(TK.TUPLE, [Int()])
   61  :                                         Int(TK.INT, 3)
   62  :                         Define(TK.DEFINE, TK.EQLS, '=')
   63  :                             Ref(TK.IDNT, 'index')
   64  :                             List(TK.LIST, [Str(), Str(), Str()])
   65  :                                 Str(TK.STR, b)
   66  :                                 Str(TK.STR, c)
   67  :                                 Str(TK.STR, d)
